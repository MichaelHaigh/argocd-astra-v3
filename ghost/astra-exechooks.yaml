apiVersion: astra.netapp.io/v1
kind: ExecHook
metadata:
  name: pre-snapshot
  namespace: astra-connector
spec:
  action: snapshot
  applicationRef: ghost
  arguments:
  - pre
  enabled: true
  hookSource: IyEvYmluL3NoCgojIG1hcmlhZGJfbXlzcWwuc2gKIwojCiMgUHJlLSBhbmQgcG9zdC1zbmFwc2hvdCBleGVjdXRpb24gaG9va3MgZm9yIE1hcmlhREIgYW5kIE15U1FMIHdpdGggTmV0QXBwIEFzdHJhIENvbnRyb2wuCiMgVGVzdGVkIHdpdGggTXlTUUwgOC4wLjI5IChkZXBsb3llZCBieSBCaXRuYW1pIGhlbG0gY2hhcnQgOS4xLjcpL01hcmlhREIgMTAuNi44IChkZXBsb3llZCBieSBCaXRuYW1pIGhlbG0gY2hhcnQgMTEuMC4xMykgYW5kIE5ldEFwcCBBc3RyYSBDb250cm9sIFNlcnZpY2UgMjIuMDQuCiMKIyBhcmdzOiBbcHJlfHBvc3RdCiMgcHJlOiBGbHVzaCBhbGwgdGFibGVzIHdpdGggcmVhZCBsb2NrCiMgcG9zdDogVGFrZSBkYXRhYmFzZSBvdXQgb2YgcmVhZC1vbmx5IG1vZGUKIwoKIyBDb21wbGV4IHNoZWxsIGNvbW1hbmRzIGFyZSBkaWZmaWN1bHQgdG8gZ2V0IHJpZ2h0IHRocm91Z2ggYSByZW1vdGUgZXhlY3V0aW9uIGFwaS4KIyBGb3Igc29tZXRoaW5nIGxpa2UgdGhpcyBvYnR1c2UgcHJvY2VkdXJlLCBhbiBhbHRlcm5hdGl2ZSBhcHByb2FjaCBpcyB0byBtb3VudCBhCiMgc2NyaXB0IGludG8gdGhlIGNvbnRhaW5lci4KCiMgVG8gcXVpZXNjZSBhbmQgaG9sZCBtYXJpYWRiL215c3FsIGRhdGFiYXNlcyB3ZSBuZWVkIHRvIGl0ZXJhdGUgb3ZlciBlYWNoIG9uZQojIGFuZCBvcGVuIGEgY2xpZW50IGNvbm5lY3Rpb24gdG8gaXQsIHRoZW4gaXNzdWUgYSAnZmx1c2ggdGFibGVzIHdpdGggcmVhZCBsb2NrJwojIGFuZCB0aGVuIHNsZWVwLCBob2xkaW5nIHRoZSBjb25uZWN0aW9uIG9wZW4gaW5kZWZpbml0ZWx5LiAgV2hlbiB0aGUgc25hcHNob3QKIyBpcyBkb25lLCB0aGUgcmVhZCBsb2NrIGlzIHJlbGVhc2VkIGJ5IHRlcm1pbmF0aW5nIHRoZSBteXNxbCBwcm9jZXNzIChmcm9tCiMgb3V0c2lkZSB0aGlzIHNjcmlwdCkKCiMgREIgdmFyaWFudHMgJiBjb25maWcgdmFyczoKIwojIEl0IGRvZXMgbm90IG1hdHRlciBzaWduaWZpY2FudGx5IGlmIHdlIGFyZSB1c2luZyBNYXJpYSBvciBNeVNRTCwgYnV0IGluIGdlbmVyYWwgdGhlIGFzc3VtcHRpb24KIyBpcyB0aGF0IGlmIGFueSBvZiB0aGUgcmVsZXZhbnQgZW52aXJvbm1lbnQgdmFyaWFibGVzIHN0YXJ0aW5nIHdpdGggJ01BUklBREInIGFyZSBzZXQsIHdlJ3JlCiMgZGVhbGluZyB3aXRoIE1hcmlhIGFuZCB3ZSBzaG91bGQgcHJlZmVyIHRob3NlIHZhcmlhYmxlcyBvdmVyIHRoZSBteXNxbCB2ZXJzaW9ucy4KCiMKIyBJbnZvY2F0aW9uICYgYXV0aCB2YXJpYWJsZXMKIwpvcHRmaWxlPSIvdG1wL2ZyZWV6ZV9vcHRzIgpob3N0bmFtZT0ibG9jYWxob3N0IgpteXNxbD0ibXlzcWwgLS1kZWZhdWx0cy1leHRyYS1maWxlPSR7b3B0ZmlsZX0iCnVzZXI9InJvb3QiCnBhc3N3b3JkPSIiCgojCiMgT3BlcmF0aW9uYWwgcGFyYW1ldGVycyBhbmQgY29tbWFuZHMKIwpzbGVlcHRpbWU9ODY0MDAKc2xlZXA9IlNFTEVDVCBTTEVFUCgke3NsZWVwdGltZX0pIgpmbHVzaD0iRkxVU0ggVEFCTEVTIFdJVEggUkVBRCBMT0NLOyAke3NsZWVwfSIKCiMKIyBFcnJvciBjb2RlcwojIFRoZXNlIGFyZSBpbXBvcnRhbnQgZm9yIGZpbmRpbmcgb3V0IHdoYXQgd2VudCB3cm9uZyBmcm9tIHRoZSBvdGhlciBlbmQgb2YgdGhlIGs4cyBhcGkKIyBPbmx5IGNoYW5nZSBleGlzdGluZyBvbmVzIChkZWxldGUgZGVwcmVjYXRlZCBhbmQgc2hpZnQgY29kZXMsIGZyZXgpIGFjcm9zcyB2ZXJzaW9uIGJvdW5kYXJpZXMuCiMKZWJhc2U9MjAKI2RlcHJlY2F0ZWQ6ICQoKGViYXNlKzEpKQojZGVwcmVjYXRlZDogJCgoZWJhc2UrMikpCmVmaWxlY3JlYXRlPSQoKGViYXNlKzMpKQplc2xlZXB0aW1lPSQoKGViYXNlKzQpKQpla2lsbD0kKChlYmFzZSs1KSkKZWFjY2Vzcz0kKChlYmFzZSs2KSkKZXVzYWdlPSQoKGViYXNlKzcpKQplYmFkYWN0aW9uPSQoKGViYXNlKzgpKQoKIwojIHNldHVwX2F1dGggZmlndXJlcyBvdXQgd2hhdCB0byB1c2UgZm9yIHVzZXIgYW5kIHBhc3N3b3JkIGFuZCB3cml0ZXMgdGhlIG9wdGlvbnMgZmlsZSBvdXQKIwojIFRoZSBwYXNzd29yZCBoYW5kbGluZyBoZXJlIGlzIGJhc2VkIG9uIHRoZSBjb252ZW50aW9ucyBlc3RhYmxpc2hlZCBieSB0aGUgQml0bmFtaSBNYXJpYURCICYgTXlTUUwKIyBkb2NrZXIgaW1hZ2VzLiAgV2UgbWF5IG5lZWQgdG8gZXhwYW5kIHRoaXMgdG8gYWNjb3VudCBmb3Igb3RoZXIgdXNhZ2UgbW9kZWxzIGJ1dCBhcyBvZiB0aGUgdGltZSBvZgojIHdyaXRpbmcgZG9uJ3Qga25vdyBvZiBhbnl0aGluZyBlbHNlIHZhZ3VlbHkgc3RhbmRhcmQgaW4gdGhlIGNvbnRhaW5lciB3b3JsZC4KIwojIERvY3VtZW50YXRpb246CiMgaHR0cHM6Ly9naXRodWIuY29tL2JpdG5hbWkvYml0bmFtaS1kb2NrZXItbWFyaWFkYgojIGh0dHBzOi8vZ2l0aHViLmNvbS9iaXRuYW1pL2JpdG5hbWktZG9ja2VyLW15c3FsCiMKc2V0dXBfYXV0aCgpIHsKICBzZXR1cF91c2VyCiAgc2V0dXBfcGFzcwogIHNldHVwX2hvc3RuYW1lCiAgd3JpdGVfb3B0X2ZpbGUKICByYz0kPwogIHJldHVybiAke3JjfQp9CgojCiMgc2V0dXBfdXNlciBvdmVycmlkZXMgZGVmYXVsdHMgd2l0aCBlbnYgdmFycyBpZiBzZXQKIwpzZXR1cF91c2VyKCkgewogIGlmIFsgLW4gIiR7TUFSSUFEQl9ST09UX1VTRVJ9IiBdIDsgdGhlbgogICAgdXNlcj0ke01BUklBREJfUk9PVF9VU0VSfQogIGVsaWYgWyAtbiAiJHtNWVNRTF9ST09UX1VTRVJ9IiBdIDsgdGhlbgogICAgdXNlcj0ke01ZU1FMX1JPT1RfVVNFUn0KICBmaQp9CgojCiMgc2V0dXBfaG9zdG5hbWUgb3ZlcnJpZGVzIGRlZmF1bHRzIHdpdGggZW52IHZhcnMgaWYgc2V0CiMKc2V0dXBfaG9zdG5hbWUoKSB7CiAgaWYgWyAtbiAiJHtIT1NUTkFNRX0iIF0gOyB0aGVuCiAgICBob3N0bmFtZT0ke0hPU1ROQU1FfQogICAgbXlzcWw9IiR7bXlzcWx9ICAtaCAke2hvc3RuYW1lfSIKICBmaQp9CgojIHNldHVwX3Bhc3NfZmlsZSBvcHRpb25hbGx5IG92ZXJyaWRlcyBkZWZhdWx0cyBhbmQgdmFycyB3aXRoIGEgZmlsZQojCnNldHVwX3Bhc3NfZmlsZSgpIHsKICBpZiBbIC1uICIke01BUklBREJfUk9PVF9QQVNTV09SRF9GSUxFfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSQoY2F0ICIke01BUklBREJfUk9PVF9QQVNTV09SRF9GSUxFfSIpCiAgZWxpZiBbIC1uICIke01ZU1FMX1JPT1RfUEFTU1dPUkRfRklMRX0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0kKGNhdCAiJHtNWVNRTF9ST09UX1BBU1NXT1JEX0ZJTEV9IikKICBmaQp9CgojCiMgc2V0dXBfcGFzcyBmaWd1cmVzIG91dCBpZiB3ZSBoYXZlIGEgcGFzc3dvcmQgaW4gYW4gZW52IHZhciB0byB1c2UKIwpzZXR1cF9wYXNzKCkgewogIHNldHVwX3Bhc3NfZmlsZQogIGlmIFsgLW4gIiR7cGFzc3dvcmR9IiBdOyB0aGVuCiAgICByZXR1cm4KICBmaQogIGlmIFsgLW4gIiR7TUFSSUFEQl9ST09UX1BBU1NXT1JEfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSR7TUFSSUFEQl9ST09UX1BBU1NXT1JEfQogIGVsaWYgWyAtbiAiJHtNWVNRTF9ST09UX1BBU1NXT1JEfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSR7TVlTUUxfUk9PVF9QQVNTV09SRH0KCiAgIyBpZiBvbmx5IE1BUklBREJfTUFTVEVSX1JPT1RfUEFTU1dPUkQgaXMgc2V0LCB0aGVuIGl0J3MgYSByZXBsaWNhdGlvbiBkYiAoInNsKnYqIikKICBlbGlmIFsgLW4gIiR7TUFSSUFEQl9NQVNURVJfUk9PVF9QQVNTV09SRH0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0ke01BUklBREJfTUFTVEVSX1JPT1RfUEFTU1dPUkR9CgogIGVsaWYgWyAtbiAiJHtNWVNRTF9NQVNURVJfUk9PVF9QQVNTV09SRH0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0ke01ZU1FMX01BU1RFUl9ST09UX1BBU1NXT1JEfQogIGZpCn0KCiMKIyB0ZXN0X2FjY2VzcyBtYWtlcyBzdXJlIHdlIGNhbiBpc3N1ZSBjb21tYW5kcyB0byB0aGUgZGF0YWJhc2UKIwojIHRoZSByZWFsIGZyZWV6ZSBwcm9jZXNzZXMgYXJlIHN0YXJ0ZWQgaW4gdGhlIGJhY2tncm91bmQgYW5kIHdlIGNhbid0IGVuc3VyZSB0aGF0IHRoZXkKIyB3ZXJlIHN0YXJ0ZWQgYmFzZWQgb24gcmV0dXJuIGNvZGVzLiAgTWFrZSBzdXJlIHdlIGNhbiBleGVjdXRlIGNvbW1hbmRzIGJ5IHVzaW5nIGEgc2ltcGxlIG9uZSBoZXJlLgp0ZXN0X2FjY2VzcygpIHsKICAke215c3FsfSAtQSAtZSAnc2hvdyBwcm9jZXNzbGlzdDsnID4vZGV2L251bGwgMj4mMQogIHJjPSQ/CiAgaWYgWyAiJHtyY30iIC1uZSAiMCIgXSA7IHRoZW4KICAgIHJldHVybiAke2VhY2Nlc3N9CiAgZmkKICByZXR1cm4gMAp9CgojCiMgd3JpdGVfb3B0X2ZpbGUgd3JpdGVzIG91dCBhIHRlbXBvcmFyeSBhdXRoZW50aWNhdGlvbiBvcHRpb25zIGZpbGUgZm9yIHRoZSBteXNxbCBjbGllbnQKIwp3cml0ZV9vcHRfZmlsZSgpIHsKICBlY2hvICJbY2xpZW50XSIgPiAke29wdGZpbGV9CiAgZWNobyAidXNlcj0ke3VzZXJ9IiA+PiAke29wdGZpbGV9CiAgaWYgWyAtbiAiJHtwYXNzd29yZH0iIF0gOyB0aGVuCiAgICBlY2hvICJwYXNzd29yZD0ke3Bhc3N3b3JkfSIgPj4gJHtvcHRmaWxlfQogIGZpCiAgaWYgWyAhIC1lICR7b3B0ZmlsZX0gXSA7IHRoZW4KICAgIHJldHVybiAke2VmaWxlY3JlYXRlfQogIGZpCiAgI21ha2Ugc3VyZSBvcHQgZmlsZSBpcyBub3Qgd29ybGQgd3JpdGUtYWJsZSAKICBjaG1vZCBvLXcgJHtvcHRmaWxlfSAKICByYz0kPwogIGlmIFsgIiR7cmN9IiAtbmUgIjAiIF0gOyB0aGVuCglyZXR1cm4gJHtlZmlsZWNyZWF0ZX0KICBmaQoKICAjIFN1Y2Nlc3MKICByZXR1cm4gMAp9CgojCiMgY2xlYW51cCBkZWxldGVzIGFueSB0ZW1wb3JhcnkgZmlsZXMKIwpjbGVhbnVwKCkgewogIHJtIC1mICR7b3B0ZmlsZX0KfQoKIwojIGZyZWV6ZSBleGVjdXRlcyB0aGUgYWN0dWFsIGZyZWV6ZSBjb21tYW5kIGZvciBhIHNwZWNpZmllZCBkYXRhYmFzZQojCmZyZWV6ZSgpIHsKICBkYj0kMQoKICBlY2hvICJmcmVlemluZyAke2RifS4uIgoKICAke215c3FsfSAiJHtkYn0iIC1lICIke2ZsdXNofSIgPi9kZXYvbnVsbCAyPiYxICYKICByZXR1cm4gJD8KfQoKIwojIGZyZWV6ZV9hbGwgaXNzdWVzIGZyZWV6ZXMgZm9yIGVhY2ggZGF0YWJhc2UKIwpmcmVlemVfYWxsKCkgewogIHJjPTAKICBmb3IgaSBpbiAkKCR7bXlzcWx9IC1lICdzaG93IGRhdGFiYXNlcycgfCBncmVwIC12IERhdGFiYXNlKTsgZG8KICAgIGZyZWV6ZSAiJHtpfSIKICAgIHJjPSQ/CiAgICBpZiBbICR7cmN9IC1uZSAwIF0gOyB0aGVuCiAgICAgIGVjaG8gIkVycm9yIGZyZWV6aW5nICR7aX0iCiAgICAgIGJyZWFrCiAgICBmaQoKICAgIHdhaXRfZm9yX3NsZWVwZXJfdG9fc3RhcnQgIiR7aX0iCiAgICByYz0kPwogICAgaWYgWyAke3JjfSAtbmUgMCBdIDsgdGhlbgogICAgICBlY2hvICJFcnJvciBmbHVzaGluZyBkYXRhYmFzZSAke2l9IgogICAgICBicmVhawogICAgZmkKICBkb25lCiAgcmV0dXJuICR7cmN9Cn0KCiMKIyB3YWl0IGZvciBzbGVlcGVyIHdhaXRzIHVwIHRvIGEgdGltZW91dCBmb3IgYSBzbGVlcCBwcm9jZXNzIHRvIHN0YXJ0CiMKd2FpdF9mb3Jfc2xlZXBlcl90b19zdGFydCgpIHsKICBkYj0kMQoKICBzZWFyY2hpbmc9MAogIHRpbWVvdXQ9NjAKICB3aGlsZSBbICR7c2VhcmNoaW5nfSAtZXEgMCBdCiAgZG8KICAgIHNsZWVwIDEKICAgIHNlYXJjaGluZz0kKCR7bXlzcWx9ICIke2RifSIgLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgLWMgIiR7c2xlZXB9IikKCiAgICB0aW1lb3V0PSQoKHRpbWVvdXQtMSkpCiAgICBpZiBbICR7dGltZW91dH0gLWVxIDAgXTsgdGhlbgogICAgICBlY2hvICJ0aW1lZCBvdXQgd2FpdGluZyBmb3Igc2xlZXBlciBmb3IgJHtkYn0iCiAgICAgIHJldHVybiAke2VzbGVlcHRpbWV9CiAgICBmaQogIGRvbmUKICByZXR1cm4gMAp9CgojIHdhaXQgZm9yIHNsZWVwZXJzIHRvIGVuZCwgaG93ZXZlciwgaWYgdGhleSBkbyBub3QgZW5kIHdpdGhpbiA0NSBtaW51dGVzLCBraWxsIHRoZW0KIyBwb2xscyBldmVyeSAxMCBzZWNvbmRzIDI3MCB0aW1lcyB0byBhcnJpdmUgYXQgMjcwMCBzZWNvbmRzIHdoaWNoIGlzIDQ1IG1pbnV0ZXMKIyBzbmFwc2hvdHMgd2l0aCBob29rcyBhcmUgbGltaXRlZCB0byAzMCBtaW51dGVzLCA0NSBtaW51dGVzIHByb3ZpZGVzIGEgYnVmZmVyIGZvciB0aGF0IHRvIGZpbmlzaCBiZWZvcmUgdGltaW5nIG91dAojIHVuZGVyIG5vcm1hbCBvcGVyYXRpb24sIHRoZSAidGhhdyIgb3B0aW9uIHdpbGwga2lsbCB0aGVzZSBzbGVlcGVycyB3aGljaCB3aWxsIGFsbG93IHRoaXMgdG8gZXhpdCBub3JtYWxseSBiZWZvcmUgdGhlIDQ1IG1pbnV0ZSB0aW1lb3V0CndhaXRfZm9yX3NsZWVwZXJzX3RvX2VuZCgpIHsKICBzZWFyY2hpbmc9MQogIHRpbWVvdXQ9MjcwCiAgd2hpbGUgWyAke3NlYXJjaGluZ30gLW5lIDAgXQogIGRvCiAgICBzbGVlcCAxMAogICAgc2VhcmNoaW5nPSQoJHtteXNxbH0gLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgLWMgIiR7c2xlZXB9IikKCiAgICB0aW1lb3V0PSQoKHRpbWVvdXQtMSkpCiAgICBpZiBbICR7dGltZW91dH0gLWVxIDAgXTsgdGhlbgogICAgICBlY2hvICJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgYWxsIHNsZWVwZXJzIgogICAgICBraWxsX3NsZWVwZXJzCiAgICAgIHJldHVybiAke2VzbGVlcHRpbWV9CiAgICBmaQogIGRvbmUKICByZXR1cm4gMAp9CgojCiMga2lsbF9zbGVlcGVycyBzaHV0cyBkb3duIGFsbCBzbGVlcGluZyBsb2NrIHRocmVhZHMKIwpraWxsX3NsZWVwZXJzKCkgewogIGZvciBzbGVlcGVyIGluICQoJHtteXNxbH0gLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgIiR7c2xlZXB9IiB8IGF3ayAne3ByaW50ICQxfScpOyBkbwogICAgZWNobyAia2lsbGluZyBzbGVlcGVyICR7c2xlZXBlcn0iCiAgICAjIHRoaXMgY29tcGxhaW5zIGFib3V0IGxvc2luZyBjb25uZWN0aW9uLCBidXQgdGhlIGVycm9yIGNvZGUgY2FuIGJlIHRydXN0ZWQKICAgIGlmICEgJHtteXNxbH0gLUEgLWUgIktJTEwgJHtzbGVlcGVyfTsiOyB0aGVuCiAgICAgIGVjaG8gIkVycm9yIGtpbGxpbmcgc2xlZXBpbmcgY29ubmVjdGlvbiAke3NsZWVwZXJ9IgogICAgICByZXR1cm4gJHtla2lsbH0KICAgIGZpCiAgZG9uZQoKICByZXR1cm4gMAp9CgojCiMgdGhhdyByZXN1bWVzIGFsbCBkYXRhYmFzZXMKIwp0aGF3KCkgewogIGtpbGxfc2xlZXBlcnMKICByYz0kPwogIGlmIFsgJHtyY30gLW5lIDAgXTsgdGhlbgogICAgZWNobyAiRXJyb3IgcmVzdW1pbmcgZGF0YWJhc2VzIgogICAgcmV0dXJuICR7cmN9CiAgZmkKfQoKIwojIHByZXBhcmVfZm9yX2FjdGlvbiBzZXRzIHVwIGNvbW1vbiBwYXJhbWV0ZXJzIGFuZCBhdXRoIGZvciBhIHByaW1hcnkgYWN0aW9uCiMKcHJlcGFyZV9mb3JfYWN0aW9uKCkgewogIHNldHVwX2F1dGgKICByYz0kPwogIGlmIFsgJHtyY30gLW5lIDAgXSA7IHRoZW4KICAgIGVjaG8gIkVycm9yIGR1cmluZyBzZXR1cCIKICAgIHJldHVybiAke3JjfQogIGZpCgogIHRlc3RfYWNjZXNzCiAgcmM9JD8KICBpZiBbICR7cmN9IC1uZSAwIF07IHRoZW4KICAgIGVjaG8gIlByb2JsZW0gYWNjZXNzaW5nIGRhdGFiYXNlIgogICAgcmV0dXJuICR7cmN9CiAgZmkKfQoKIwojICJtYWluIgojCmFjdGlvbj0kMQppZiBbIC16ICIke2FjdGlvbn0iIF07IHRoZW4KICBlY2hvICJVc2FnZTogJDAgPHByZXxwb3N0PiIKICBleGl0ICR7ZXVzYWdlfQpmaQoKaWYgWyAiJHthY3Rpb259IiAhPSAicHJlIiBdICYmIFsgIiR7YWN0aW9ufSIgIT0gInBvc3QiIF07IHRoZW4KICBlY2hvICJJbnZhbGlkIHN1YmNvbW1hbmQ6ICR7YWN0aW9ufSIKICBleGl0ICR7ZWJhZGFjdGlvbn0KZmkKCnByZXBhcmVfZm9yX2FjdGlvbgpyYz0kPwppZiBbICR7cmN9IC1uZSAwIF07IHRoZW4KICBlY2hvICJFcnJvciBzZXR0aW5nIHVwIGZvciAke2FjdGlvbn0iCiAgY2xlYW51cAogIGV4aXQgJHtyY30KZmkKCmlmIFsgIiR7YWN0aW9ufSIgPSAicHJlIiBdOyB0aGVuCiAgZnJlZXplX2FsbAogIHJjPSQ/CiAgaWYgWyAke3JjfSAtbmUgMCBdOyB0aGVuCiAgICBlY2hvICJFcnJvciBmcmVlemluZyBkYXRhYmFzZXMiCiAgICAjIGZhbGwgdGhyb3VnaCB0byBjbGVhbnVwCiAgICBraWxsX3NsZWVwZXJzCiAgZWxzZQogICAgZWNobyAiX19Ib29rX1JlYWR5X1N0YXRlX18iCiAgICB3YWl0X2Zvcl9zbGVlcGVyc190b19lbmQKICBmaQplbHNlCiAgdGhhdwogIHJjPSQ/CiAgaWYgWyAke3JjfSAtbmUgMCBdIDsgdGhlbgogICAgZWNobyAiRXJyb3IgdGhhd2luZyBkYXRhYmFzZXMiCiAgICAjIGZhbGwgdGhyb3VnaCB0byBjbGVhbnVwCiAgZmkKZmkKCmNsZWFudXAKZXhpdCAke3JjfQ==
  matchingCriteria:
  - type: containerImage
    value: mysql
  stage: pre
---
apiVersion: astra.netapp.io/v1
kind: ExecHook
metadata:
  name: post-snapshot
  namespace: astra-connector
spec:
  action: snapshot
  applicationRef: ghost
  arguments:
  - post
  enabled: true
  hookSource: IyEvYmluL3NoCgojIG1hcmlhZGJfbXlzcWwuc2gKIwojCiMgUHJlLSBhbmQgcG9zdC1zbmFwc2hvdCBleGVjdXRpb24gaG9va3MgZm9yIE1hcmlhREIgYW5kIE15U1FMIHdpdGggTmV0QXBwIEFzdHJhIENvbnRyb2wuCiMgVGVzdGVkIHdpdGggTXlTUUwgOC4wLjI5IChkZXBsb3llZCBieSBCaXRuYW1pIGhlbG0gY2hhcnQgOS4xLjcpL01hcmlhREIgMTAuNi44IChkZXBsb3llZCBieSBCaXRuYW1pIGhlbG0gY2hhcnQgMTEuMC4xMykgYW5kIE5ldEFwcCBBc3RyYSBDb250cm9sIFNlcnZpY2UgMjIuMDQuCiMKIyBhcmdzOiBbcHJlfHBvc3RdCiMgcHJlOiBGbHVzaCBhbGwgdGFibGVzIHdpdGggcmVhZCBsb2NrCiMgcG9zdDogVGFrZSBkYXRhYmFzZSBvdXQgb2YgcmVhZC1vbmx5IG1vZGUKIwoKIyBDb21wbGV4IHNoZWxsIGNvbW1hbmRzIGFyZSBkaWZmaWN1bHQgdG8gZ2V0IHJpZ2h0IHRocm91Z2ggYSByZW1vdGUgZXhlY3V0aW9uIGFwaS4KIyBGb3Igc29tZXRoaW5nIGxpa2UgdGhpcyBvYnR1c2UgcHJvY2VkdXJlLCBhbiBhbHRlcm5hdGl2ZSBhcHByb2FjaCBpcyB0byBtb3VudCBhCiMgc2NyaXB0IGludG8gdGhlIGNvbnRhaW5lci4KCiMgVG8gcXVpZXNjZSBhbmQgaG9sZCBtYXJpYWRiL215c3FsIGRhdGFiYXNlcyB3ZSBuZWVkIHRvIGl0ZXJhdGUgb3ZlciBlYWNoIG9uZQojIGFuZCBvcGVuIGEgY2xpZW50IGNvbm5lY3Rpb24gdG8gaXQsIHRoZW4gaXNzdWUgYSAnZmx1c2ggdGFibGVzIHdpdGggcmVhZCBsb2NrJwojIGFuZCB0aGVuIHNsZWVwLCBob2xkaW5nIHRoZSBjb25uZWN0aW9uIG9wZW4gaW5kZWZpbml0ZWx5LiAgV2hlbiB0aGUgc25hcHNob3QKIyBpcyBkb25lLCB0aGUgcmVhZCBsb2NrIGlzIHJlbGVhc2VkIGJ5IHRlcm1pbmF0aW5nIHRoZSBteXNxbCBwcm9jZXNzIChmcm9tCiMgb3V0c2lkZSB0aGlzIHNjcmlwdCkKCiMgREIgdmFyaWFudHMgJiBjb25maWcgdmFyczoKIwojIEl0IGRvZXMgbm90IG1hdHRlciBzaWduaWZpY2FudGx5IGlmIHdlIGFyZSB1c2luZyBNYXJpYSBvciBNeVNRTCwgYnV0IGluIGdlbmVyYWwgdGhlIGFzc3VtcHRpb24KIyBpcyB0aGF0IGlmIGFueSBvZiB0aGUgcmVsZXZhbnQgZW52aXJvbm1lbnQgdmFyaWFibGVzIHN0YXJ0aW5nIHdpdGggJ01BUklBREInIGFyZSBzZXQsIHdlJ3JlCiMgZGVhbGluZyB3aXRoIE1hcmlhIGFuZCB3ZSBzaG91bGQgcHJlZmVyIHRob3NlIHZhcmlhYmxlcyBvdmVyIHRoZSBteXNxbCB2ZXJzaW9ucy4KCiMKIyBJbnZvY2F0aW9uICYgYXV0aCB2YXJpYWJsZXMKIwpvcHRmaWxlPSIvdG1wL2ZyZWV6ZV9vcHRzIgpob3N0bmFtZT0ibG9jYWxob3N0IgpteXNxbD0ibXlzcWwgLS1kZWZhdWx0cy1leHRyYS1maWxlPSR7b3B0ZmlsZX0iCnVzZXI9InJvb3QiCnBhc3N3b3JkPSIiCgojCiMgT3BlcmF0aW9uYWwgcGFyYW1ldGVycyBhbmQgY29tbWFuZHMKIwpzbGVlcHRpbWU9ODY0MDAKc2xlZXA9IlNFTEVDVCBTTEVFUCgke3NsZWVwdGltZX0pIgpmbHVzaD0iRkxVU0ggVEFCTEVTIFdJVEggUkVBRCBMT0NLOyAke3NsZWVwfSIKCiMKIyBFcnJvciBjb2RlcwojIFRoZXNlIGFyZSBpbXBvcnRhbnQgZm9yIGZpbmRpbmcgb3V0IHdoYXQgd2VudCB3cm9uZyBmcm9tIHRoZSBvdGhlciBlbmQgb2YgdGhlIGs4cyBhcGkKIyBPbmx5IGNoYW5nZSBleGlzdGluZyBvbmVzIChkZWxldGUgZGVwcmVjYXRlZCBhbmQgc2hpZnQgY29kZXMsIGZyZXgpIGFjcm9zcyB2ZXJzaW9uIGJvdW5kYXJpZXMuCiMKZWJhc2U9MjAKI2RlcHJlY2F0ZWQ6ICQoKGViYXNlKzEpKQojZGVwcmVjYXRlZDogJCgoZWJhc2UrMikpCmVmaWxlY3JlYXRlPSQoKGViYXNlKzMpKQplc2xlZXB0aW1lPSQoKGViYXNlKzQpKQpla2lsbD0kKChlYmFzZSs1KSkKZWFjY2Vzcz0kKChlYmFzZSs2KSkKZXVzYWdlPSQoKGViYXNlKzcpKQplYmFkYWN0aW9uPSQoKGViYXNlKzgpKQoKIwojIHNldHVwX2F1dGggZmlndXJlcyBvdXQgd2hhdCB0byB1c2UgZm9yIHVzZXIgYW5kIHBhc3N3b3JkIGFuZCB3cml0ZXMgdGhlIG9wdGlvbnMgZmlsZSBvdXQKIwojIFRoZSBwYXNzd29yZCBoYW5kbGluZyBoZXJlIGlzIGJhc2VkIG9uIHRoZSBjb252ZW50aW9ucyBlc3RhYmxpc2hlZCBieSB0aGUgQml0bmFtaSBNYXJpYURCICYgTXlTUUwKIyBkb2NrZXIgaW1hZ2VzLiAgV2UgbWF5IG5lZWQgdG8gZXhwYW5kIHRoaXMgdG8gYWNjb3VudCBmb3Igb3RoZXIgdXNhZ2UgbW9kZWxzIGJ1dCBhcyBvZiB0aGUgdGltZSBvZgojIHdyaXRpbmcgZG9uJ3Qga25vdyBvZiBhbnl0aGluZyBlbHNlIHZhZ3VlbHkgc3RhbmRhcmQgaW4gdGhlIGNvbnRhaW5lciB3b3JsZC4KIwojIERvY3VtZW50YXRpb246CiMgaHR0cHM6Ly9naXRodWIuY29tL2JpdG5hbWkvYml0bmFtaS1kb2NrZXItbWFyaWFkYgojIGh0dHBzOi8vZ2l0aHViLmNvbS9iaXRuYW1pL2JpdG5hbWktZG9ja2VyLW15c3FsCiMKc2V0dXBfYXV0aCgpIHsKICBzZXR1cF91c2VyCiAgc2V0dXBfcGFzcwogIHNldHVwX2hvc3RuYW1lCiAgd3JpdGVfb3B0X2ZpbGUKICByYz0kPwogIHJldHVybiAke3JjfQp9CgojCiMgc2V0dXBfdXNlciBvdmVycmlkZXMgZGVmYXVsdHMgd2l0aCBlbnYgdmFycyBpZiBzZXQKIwpzZXR1cF91c2VyKCkgewogIGlmIFsgLW4gIiR7TUFSSUFEQl9ST09UX1VTRVJ9IiBdIDsgdGhlbgogICAgdXNlcj0ke01BUklBREJfUk9PVF9VU0VSfQogIGVsaWYgWyAtbiAiJHtNWVNRTF9ST09UX1VTRVJ9IiBdIDsgdGhlbgogICAgdXNlcj0ke01ZU1FMX1JPT1RfVVNFUn0KICBmaQp9CgojCiMgc2V0dXBfaG9zdG5hbWUgb3ZlcnJpZGVzIGRlZmF1bHRzIHdpdGggZW52IHZhcnMgaWYgc2V0CiMKc2V0dXBfaG9zdG5hbWUoKSB7CiAgaWYgWyAtbiAiJHtIT1NUTkFNRX0iIF0gOyB0aGVuCiAgICBob3N0bmFtZT0ke0hPU1ROQU1FfQogICAgbXlzcWw9IiR7bXlzcWx9ICAtaCAke2hvc3RuYW1lfSIKICBmaQp9CgojIHNldHVwX3Bhc3NfZmlsZSBvcHRpb25hbGx5IG92ZXJyaWRlcyBkZWZhdWx0cyBhbmQgdmFycyB3aXRoIGEgZmlsZQojCnNldHVwX3Bhc3NfZmlsZSgpIHsKICBpZiBbIC1uICIke01BUklBREJfUk9PVF9QQVNTV09SRF9GSUxFfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSQoY2F0ICIke01BUklBREJfUk9PVF9QQVNTV09SRF9GSUxFfSIpCiAgZWxpZiBbIC1uICIke01ZU1FMX1JPT1RfUEFTU1dPUkRfRklMRX0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0kKGNhdCAiJHtNWVNRTF9ST09UX1BBU1NXT1JEX0ZJTEV9IikKICBmaQp9CgojCiMgc2V0dXBfcGFzcyBmaWd1cmVzIG91dCBpZiB3ZSBoYXZlIGEgcGFzc3dvcmQgaW4gYW4gZW52IHZhciB0byB1c2UKIwpzZXR1cF9wYXNzKCkgewogIHNldHVwX3Bhc3NfZmlsZQogIGlmIFsgLW4gIiR7cGFzc3dvcmR9IiBdOyB0aGVuCiAgICByZXR1cm4KICBmaQogIGlmIFsgLW4gIiR7TUFSSUFEQl9ST09UX1BBU1NXT1JEfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSR7TUFSSUFEQl9ST09UX1BBU1NXT1JEfQogIGVsaWYgWyAtbiAiJHtNWVNRTF9ST09UX1BBU1NXT1JEfSIgXSA7IHRoZW4KICAgIHBhc3N3b3JkPSR7TVlTUUxfUk9PVF9QQVNTV09SRH0KCiAgIyBpZiBvbmx5IE1BUklBREJfTUFTVEVSX1JPT1RfUEFTU1dPUkQgaXMgc2V0LCB0aGVuIGl0J3MgYSByZXBsaWNhdGlvbiBkYiAoInNsKnYqIikKICBlbGlmIFsgLW4gIiR7TUFSSUFEQl9NQVNURVJfUk9PVF9QQVNTV09SRH0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0ke01BUklBREJfTUFTVEVSX1JPT1RfUEFTU1dPUkR9CgogIGVsaWYgWyAtbiAiJHtNWVNRTF9NQVNURVJfUk9PVF9QQVNTV09SRH0iIF0gOyB0aGVuCiAgICBwYXNzd29yZD0ke01ZU1FMX01BU1RFUl9ST09UX1BBU1NXT1JEfQogIGZpCn0KCiMKIyB0ZXN0X2FjY2VzcyBtYWtlcyBzdXJlIHdlIGNhbiBpc3N1ZSBjb21tYW5kcyB0byB0aGUgZGF0YWJhc2UKIwojIHRoZSByZWFsIGZyZWV6ZSBwcm9jZXNzZXMgYXJlIHN0YXJ0ZWQgaW4gdGhlIGJhY2tncm91bmQgYW5kIHdlIGNhbid0IGVuc3VyZSB0aGF0IHRoZXkKIyB3ZXJlIHN0YXJ0ZWQgYmFzZWQgb24gcmV0dXJuIGNvZGVzLiAgTWFrZSBzdXJlIHdlIGNhbiBleGVjdXRlIGNvbW1hbmRzIGJ5IHVzaW5nIGEgc2ltcGxlIG9uZSBoZXJlLgp0ZXN0X2FjY2VzcygpIHsKICAke215c3FsfSAtQSAtZSAnc2hvdyBwcm9jZXNzbGlzdDsnID4vZGV2L251bGwgMj4mMQogIHJjPSQ/CiAgaWYgWyAiJHtyY30iIC1uZSAiMCIgXSA7IHRoZW4KICAgIHJldHVybiAke2VhY2Nlc3N9CiAgZmkKICByZXR1cm4gMAp9CgojCiMgd3JpdGVfb3B0X2ZpbGUgd3JpdGVzIG91dCBhIHRlbXBvcmFyeSBhdXRoZW50aWNhdGlvbiBvcHRpb25zIGZpbGUgZm9yIHRoZSBteXNxbCBjbGllbnQKIwp3cml0ZV9vcHRfZmlsZSgpIHsKICBlY2hvICJbY2xpZW50XSIgPiAke29wdGZpbGV9CiAgZWNobyAidXNlcj0ke3VzZXJ9IiA+PiAke29wdGZpbGV9CiAgaWYgWyAtbiAiJHtwYXNzd29yZH0iIF0gOyB0aGVuCiAgICBlY2hvICJwYXNzd29yZD0ke3Bhc3N3b3JkfSIgPj4gJHtvcHRmaWxlfQogIGZpCiAgaWYgWyAhIC1lICR7b3B0ZmlsZX0gXSA7IHRoZW4KICAgIHJldHVybiAke2VmaWxlY3JlYXRlfQogIGZpCiAgI21ha2Ugc3VyZSBvcHQgZmlsZSBpcyBub3Qgd29ybGQgd3JpdGUtYWJsZSAKICBjaG1vZCBvLXcgJHtvcHRmaWxlfSAKICByYz0kPwogIGlmIFsgIiR7cmN9IiAtbmUgIjAiIF0gOyB0aGVuCglyZXR1cm4gJHtlZmlsZWNyZWF0ZX0KICBmaQoKICAjIFN1Y2Nlc3MKICByZXR1cm4gMAp9CgojCiMgY2xlYW51cCBkZWxldGVzIGFueSB0ZW1wb3JhcnkgZmlsZXMKIwpjbGVhbnVwKCkgewogIHJtIC1mICR7b3B0ZmlsZX0KfQoKIwojIGZyZWV6ZSBleGVjdXRlcyB0aGUgYWN0dWFsIGZyZWV6ZSBjb21tYW5kIGZvciBhIHNwZWNpZmllZCBkYXRhYmFzZQojCmZyZWV6ZSgpIHsKICBkYj0kMQoKICBlY2hvICJmcmVlemluZyAke2RifS4uIgoKICAke215c3FsfSAiJHtkYn0iIC1lICIke2ZsdXNofSIgPi9kZXYvbnVsbCAyPiYxICYKICByZXR1cm4gJD8KfQoKIwojIGZyZWV6ZV9hbGwgaXNzdWVzIGZyZWV6ZXMgZm9yIGVhY2ggZGF0YWJhc2UKIwpmcmVlemVfYWxsKCkgewogIHJjPTAKICBmb3IgaSBpbiAkKCR7bXlzcWx9IC1lICdzaG93IGRhdGFiYXNlcycgfCBncmVwIC12IERhdGFiYXNlKTsgZG8KICAgIGZyZWV6ZSAiJHtpfSIKICAgIHJjPSQ/CiAgICBpZiBbICR7cmN9IC1uZSAwIF0gOyB0aGVuCiAgICAgIGVjaG8gIkVycm9yIGZyZWV6aW5nICR7aX0iCiAgICAgIGJyZWFrCiAgICBmaQoKICAgIHdhaXRfZm9yX3NsZWVwZXJfdG9fc3RhcnQgIiR7aX0iCiAgICByYz0kPwogICAgaWYgWyAke3JjfSAtbmUgMCBdIDsgdGhlbgogICAgICBlY2hvICJFcnJvciBmbHVzaGluZyBkYXRhYmFzZSAke2l9IgogICAgICBicmVhawogICAgZmkKICBkb25lCiAgcmV0dXJuICR7cmN9Cn0KCiMKIyB3YWl0IGZvciBzbGVlcGVyIHdhaXRzIHVwIHRvIGEgdGltZW91dCBmb3IgYSBzbGVlcCBwcm9jZXNzIHRvIHN0YXJ0CiMKd2FpdF9mb3Jfc2xlZXBlcl90b19zdGFydCgpIHsKICBkYj0kMQoKICBzZWFyY2hpbmc9MAogIHRpbWVvdXQ9NjAKICB3aGlsZSBbICR7c2VhcmNoaW5nfSAtZXEgMCBdCiAgZG8KICAgIHNsZWVwIDEKICAgIHNlYXJjaGluZz0kKCR7bXlzcWx9ICIke2RifSIgLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgLWMgIiR7c2xlZXB9IikKCiAgICB0aW1lb3V0PSQoKHRpbWVvdXQtMSkpCiAgICBpZiBbICR7dGltZW91dH0gLWVxIDAgXTsgdGhlbgogICAgICBlY2hvICJ0aW1lZCBvdXQgd2FpdGluZyBmb3Igc2xlZXBlciBmb3IgJHtkYn0iCiAgICAgIHJldHVybiAke2VzbGVlcHRpbWV9CiAgICBmaQogIGRvbmUKICByZXR1cm4gMAp9CgojIHdhaXQgZm9yIHNsZWVwZXJzIHRvIGVuZCwgaG93ZXZlciwgaWYgdGhleSBkbyBub3QgZW5kIHdpdGhpbiA0NSBtaW51dGVzLCBraWxsIHRoZW0KIyBwb2xscyBldmVyeSAxMCBzZWNvbmRzIDI3MCB0aW1lcyB0byBhcnJpdmUgYXQgMjcwMCBzZWNvbmRzIHdoaWNoIGlzIDQ1IG1pbnV0ZXMKIyBzbmFwc2hvdHMgd2l0aCBob29rcyBhcmUgbGltaXRlZCB0byAzMCBtaW51dGVzLCA0NSBtaW51dGVzIHByb3ZpZGVzIGEgYnVmZmVyIGZvciB0aGF0IHRvIGZpbmlzaCBiZWZvcmUgdGltaW5nIG91dAojIHVuZGVyIG5vcm1hbCBvcGVyYXRpb24sIHRoZSAidGhhdyIgb3B0aW9uIHdpbGwga2lsbCB0aGVzZSBzbGVlcGVycyB3aGljaCB3aWxsIGFsbG93IHRoaXMgdG8gZXhpdCBub3JtYWxseSBiZWZvcmUgdGhlIDQ1IG1pbnV0ZSB0aW1lb3V0CndhaXRfZm9yX3NsZWVwZXJzX3RvX2VuZCgpIHsKICBzZWFyY2hpbmc9MQogIHRpbWVvdXQ9MjcwCiAgd2hpbGUgWyAke3NlYXJjaGluZ30gLW5lIDAgXQogIGRvCiAgICBzbGVlcCAxMAogICAgc2VhcmNoaW5nPSQoJHtteXNxbH0gLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgLWMgIiR7c2xlZXB9IikKCiAgICB0aW1lb3V0PSQoKHRpbWVvdXQtMSkpCiAgICBpZiBbICR7dGltZW91dH0gLWVxIDAgXTsgdGhlbgogICAgICBlY2hvICJ0aW1lZCBvdXQgd2FpdGluZyBmb3IgYWxsIHNsZWVwZXJzIgogICAgICBraWxsX3NsZWVwZXJzCiAgICAgIHJldHVybiAke2VzbGVlcHRpbWV9CiAgICBmaQogIGRvbmUKICByZXR1cm4gMAp9CgojCiMga2lsbF9zbGVlcGVycyBzaHV0cyBkb3duIGFsbCBzbGVlcGluZyBsb2NrIHRocmVhZHMKIwpraWxsX3NsZWVwZXJzKCkgewogIGZvciBzbGVlcGVyIGluICQoJHtteXNxbH0gLUEgLWUgInNob3cgcHJvY2Vzc2xpc3Q7IiB8IGdyZXAgIiR7c2xlZXB9IiB8IGF3ayAne3ByaW50ICQxfScpOyBkbwogICAgZWNobyAia2lsbGluZyBzbGVlcGVyICR7c2xlZXBlcn0iCiAgICAjIHRoaXMgY29tcGxhaW5zIGFib3V0IGxvc2luZyBjb25uZWN0aW9uLCBidXQgdGhlIGVycm9yIGNvZGUgY2FuIGJlIHRydXN0ZWQKICAgIGlmICEgJHtteXNxbH0gLUEgLWUgIktJTEwgJHtzbGVlcGVyfTsiOyB0aGVuCiAgICAgIGVjaG8gIkVycm9yIGtpbGxpbmcgc2xlZXBpbmcgY29ubmVjdGlvbiAke3NsZWVwZXJ9IgogICAgICByZXR1cm4gJHtla2lsbH0KICAgIGZpCiAgZG9uZQoKICByZXR1cm4gMAp9CgojCiMgdGhhdyByZXN1bWVzIGFsbCBkYXRhYmFzZXMKIwp0aGF3KCkgewogIGtpbGxfc2xlZXBlcnMKICByYz0kPwogIGlmIFsgJHtyY30gLW5lIDAgXTsgdGhlbgogICAgZWNobyAiRXJyb3IgcmVzdW1pbmcgZGF0YWJhc2VzIgogICAgcmV0dXJuICR7cmN9CiAgZmkKfQoKIwojIHByZXBhcmVfZm9yX2FjdGlvbiBzZXRzIHVwIGNvbW1vbiBwYXJhbWV0ZXJzIGFuZCBhdXRoIGZvciBhIHByaW1hcnkgYWN0aW9uCiMKcHJlcGFyZV9mb3JfYWN0aW9uKCkgewogIHNldHVwX2F1dGgKICByYz0kPwogIGlmIFsgJHtyY30gLW5lIDAgXSA7IHRoZW4KICAgIGVjaG8gIkVycm9yIGR1cmluZyBzZXR1cCIKICAgIHJldHVybiAke3JjfQogIGZpCgogIHRlc3RfYWNjZXNzCiAgcmM9JD8KICBpZiBbICR7cmN9IC1uZSAwIF07IHRoZW4KICAgIGVjaG8gIlByb2JsZW0gYWNjZXNzaW5nIGRhdGFiYXNlIgogICAgcmV0dXJuICR7cmN9CiAgZmkKfQoKIwojICJtYWluIgojCmFjdGlvbj0kMQppZiBbIC16ICIke2FjdGlvbn0iIF07IHRoZW4KICBlY2hvICJVc2FnZTogJDAgPHByZXxwb3N0PiIKICBleGl0ICR7ZXVzYWdlfQpmaQoKaWYgWyAiJHthY3Rpb259IiAhPSAicHJlIiBdICYmIFsgIiR7YWN0aW9ufSIgIT0gInBvc3QiIF07IHRoZW4KICBlY2hvICJJbnZhbGlkIHN1YmNvbW1hbmQ6ICR7YWN0aW9ufSIKICBleGl0ICR7ZWJhZGFjdGlvbn0KZmkKCnByZXBhcmVfZm9yX2FjdGlvbgpyYz0kPwppZiBbICR7cmN9IC1uZSAwIF07IHRoZW4KICBlY2hvICJFcnJvciBzZXR0aW5nIHVwIGZvciAke2FjdGlvbn0iCiAgY2xlYW51cAogIGV4aXQgJHtyY30KZmkKCmlmIFsgIiR7YWN0aW9ufSIgPSAicHJlIiBdOyB0aGVuCiAgZnJlZXplX2FsbAogIHJjPSQ/CiAgaWYgWyAke3JjfSAtbmUgMCBdOyB0aGVuCiAgICBlY2hvICJFcnJvciBmcmVlemluZyBkYXRhYmFzZXMiCiAgICAjIGZhbGwgdGhyb3VnaCB0byBjbGVhbnVwCiAgICBraWxsX3NsZWVwZXJzCiAgZWxzZQogICAgZWNobyAiX19Ib29rX1JlYWR5X1N0YXRlX18iCiAgICB3YWl0X2Zvcl9zbGVlcGVyc190b19lbmQKICBmaQplbHNlCiAgdGhhdwogIHJjPSQ/CiAgaWYgWyAke3JjfSAtbmUgMCBdIDsgdGhlbgogICAgZWNobyAiRXJyb3IgdGhhd2luZyBkYXRhYmFzZXMiCiAgICAjIGZhbGwgdGhyb3VnaCB0byBjbGVhbnVwCiAgZmkKZmkKCmNsZWFudXAKZXhpdCAke3JjfQ==
  matchingCriteria:
  - type: containerImage
    value: mysql
  stage: post
